---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: swagger-ui
  namespace: pfire
spec:
  interval: 15m
  chart:
    spec:
      chart: swagger-ui
      version: 0.3.6
      sourceRef:
        kind: HelmRepository
        name: cetic-charts
        namespace: flux-system
  values:
    image:
      registry: docker.io
      repository: swaggerapi/swagger-ui
      pullPolicy: IfNotPresent

    swaggerui:
      jsonUrl: "http://petstore.swagger.io/v2/swagger.json"

    service:
      type: ClusterIP
      port: 8080

    ingress:
      enabled: true
      annotations:
        hajimari.io/enable: "true"
        hajimari.io/icon: "weather-sunset"
        hajimari.io/group: "pfire"
        nginx.ingress.kubernetes.io/auth-url: "https://auth.${SECRET_DOMAIN}/oauth2/auth"
        nginx.ingress.kubernetes.io/auth-signin: https://auth.${SECRET_DOMAIN}/oauth2/start
        kubernetes.io/ingress.class: nginx
      hosts:
        - host: swagger-ui.${SECRET_DOMAIN}
          paths:
            - path: /
              pathType: Prefix
      tls:
        - hosts:
            - "swagger-ui.${SECRET_DOMAIN}"
